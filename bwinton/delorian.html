<!doctype html>
<html>

    <head>
        <meta charset="utf-8"/>
        <title>delorean</title>
        <link rel="stylesheet" type="text/css" media="all"
href="http://mozilla.seanmartell.com/delorean/screen-fixed.css" />
    </head>
    
    <body lang="en">
    
        <div id="console">
        
            <div class="timeline orange">
            
                <p>Future Release Time</p>
            
                <div class="month">         
                    <div class="digit"><p>month</p>
                    <div class="char">J</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">U</div><div
class="char blank">8</div></div>
                    <div class="digit"><div class="char">N</div><div
class="char blank">8</div></div>
                </div>
                
                <div class="day">           
                    <div class="digit"><p>day</p>
                    <div class="char">2</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">8</div><div
class="char blank">8</div></div>
                </div>
                
                <div class="year">          
                    <div class="digit"><p>year</p>
                    <div class="char">2</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">0</div><div
class="char blank">8</div></div>
                    <div class="digit"><div class="char">1</div><div
class="char blank">8</div></div>
                    <div class="digit"><div class="char">2</div><div
class="char blank">8</div></div>            
                </div>
                
                <div class="digit dots am"><p>am</p><div
class="char">.</div></div>
                <div class="digit dots pm dark"><p>pm</p><div
class="char">.</div></div>
                
                <div class="hour">          
                    <div class="digit"><p>hour</p>
                    <div class="char">1</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">2</div><div
class="char blank">8</div></div>
                </div>
                
                <div class="digit dots colon"><div
class="char">:</div></div>
                
                <div class="minute">            
                    <div class="digit"><p>min</p>
                    <div class="char">3</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">4</div><div
class="char blank">8</div></div>
                </div>
            
            </div>
            
            <div class="timeline green">
            
                <p>Present Time</p>
            
                <div class="month">         
                    <div class="digit"><p>month</p>
                    <div class="char">J</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">U</div><div
class="char blank">8</div></div>
                    <div class="digit"><div class="char">N</div><div
class="char blank">8</div></div>
                </div>
                
                <div class="day">           
                    <div class="digit"><p>day</p>
                    <div class="char">2</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">8</div><div
class="char blank">8</div></div>
                </div>
                
                <div class="year">          
                    <div class="digit"><p>year</p>
                    <div class="char">1</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">9</div><div
class="char blank">8</div></div>
                    <div class="digit"><div class="char">8</div><div
class="char blank">8</div></div>
                    <div class="digit"><div class="char">5</div><div
class="char blank">8</div></div>            
                </div>
                
                <div class="digit dots am"><p>am</p><div
class="char">.</div></div>
                <div class="digit dots pm dark"><p>pm</p><div
class="char">.</div></div>
                
                <div class="hour">          
                    <div class="digit"><p>hour</p>
                    <div class="char">1</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">2</div><div
class="char blank">8</div></div>
                </div>
                
                <div class="digit dots colon"><div
class="char">:</div></div>
                
                <div class="minute">            
                    <div class="digit"><p>min</p>
                    <div class="char">3</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">4</div><div
class="char blank">8</div></div>
                </div>
            
            </div>
            
            <div class="timeline yellow">
            
                <p>Last Time Released</p>
            
                <div class="month">         
                    <div class="digit"><p>month</p>
                    <div class="char">J</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">U</div><div
class="char blank">8</div></div>
                    <div class="digit"><div class="char">N</div><div
class="char blank">8</div></div>
                </div>
                
                <div class="day">           
                    <div class="digit"><p>day</p>
                    <div class="char">2</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">8</div><div
class="char blank">8</div></div>
                </div>
                
                <div class="year">          
                    <div class="digit"><p>year</p>
                    <div class="char">1</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">9</div><div
class="char blank">8</div></div>
                    <div class="digit"><div class="char">5</div><div
class="char blank">8</div></div>
                    <div class="digit"><div class="char">5</div><div
class="char blank">8</div></div>            
                </div>
                
                <div class="digit dots am"><p>am</p><div
class="char">.</div></div>
                <div class="digit dots pm dark"><p>pm</p><div
class="char">.</div></div>
                
                <div class="hour">          
                    <div class="digit"><p>hour</p>
                    <div class="char">1</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">2</div><div
class="char blank">8</div></div>
                </div>
                
                <div class="digit dots colon"><div
class="char">:</div></div>
                
                <div class="minute">            
                    <div class="digit"><p>min</p>
                    <div class="char">3</div><div class="char
blank">8</div></div>
                    <div class="digit"><div class="char">4</div><div
class="char blank">8</div></div>
                </div>
            
            </div>
        
        </div>
        
    </body>
    
</html>

<script>
// Add script to bottom of page

// Convert a JS Date object to an array of characters
function dateToArray(date) {
  console.log("Converting date: " + date);
  var a = [];
  var s = date.toString().toUpperCase().split(" ");
  // eg "FRI JUN 29 2012 16:22:59 GMT-0700 (PDT)"
  var month = s[1],
      day = s[2],
      year = s[3],
      time = s[4].split(":").splice(0,2).join(":"); // remove seconds

  a = a.concat(month.split("")); // Month
  a = a.concat(day.split("")); // Day
  a = a.concat(year.split("")); // Year
  a = a.concat(['.', '.']); // AM/PM dots
  a = a.concat(time.split("")); // Time

  return a;
}

// Fill in a timeline with the given date.
function setTimelineChars(timeline, date) {
  var chars = dateToArray(date);
  var c = timeline.querySelectorAll(".digit > .char:not(.blank)");
  if (c.length != chars.length)
    console.log("UHOH! Found " + c.length + " chars in page, have " +
chars.length + "in array!");

  for (i = 0; i < c.length; i++) {
    c[i].textContent = chars[i];
  }

  // Set AM/PM flag
  console.log(date.getHours());
  if(date.getHours() < 12) {
    timeline.querySelector('.dots.pm').classList.add('dark');
    timeline.querySelector('.dots.am').classList.remove('dark');
  } else {
    timeline.querySelector('.dots.am').classList.add('dark');
    timeline.querySelector('.dots.pm').classList.remove('dark');
  }
}

var line;
var future = new Date(Date.parse("06 Jan 2013 09:00:00 GMT-0500")); // XXX PST vs PDT?
var past = new Date(Date.parse("30 Nov 2012 09:00:00 GMT-0500"));

line = document.querySelector(".orange");
setTimelineChars(line, future);

function setCurrent() {
  var current = new Date();
  line = document.querySelector(".green");
  setTimelineChars(line, current);
}

setCurrent();
setInterval(setCurrent, 5000);

line = document.querySelector(".yellow");
setTimelineChars(line, past);

console.log("Done! Great Scott!");

</script>
