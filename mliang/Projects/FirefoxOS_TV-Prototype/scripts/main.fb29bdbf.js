function initSmartHome(){updateClock(),initColor(),initPosition(),wave[0]=new TimelineMax({repeat:-1}),wave[1]=new TimelineMax({repeat:-1}),wave[0].fromTo($(".wave01a"),3,{x:"0px"},{x:"-600px",ease:Linear.easeNone}),wave[1].fromTo($(".wave01b"),3.1,{x:"-100px"},{x:"-700px",ease:Linear.easeNone}),playWave(!1)}function pad(a,b){return a=a.toString(),a.length<b?pad("0"+a,b):a}function initColor(){for(var a=0;a<Object.keys(colors).length;a++){var b="app0"+(a+1),c=$("#"+b);c.css("background-color",colors[b])}var d=$(".appbutton[data-number="+stage+"]").attr("id");TweenLite.to($(".transition"),.001,{backgroundColor:colors[d]}),TweenLite.to($("#dummy"),.001,{backgroundColor:colors[d]})}function initPosition(){if(5>=count)for(var a=0;count>a;a++){var b=$(".appbutton[data-number="+(a+1)+"]");b.css("margin-left",(1920-300*count)/2+a*(300+100/count)-40)}else for(var a=0;count>a;a++){var b=$(".appbutton[data-number="+(a+1)+"]");b.css("margin-left",210+320*a-40)}var c=0;$(".filter-section li").each(function(a){$(this).css("margin-left",50*parseInt(a+1)+parseInt(c)),c+=$(this).width()});var d=$(".appbutton");d.opening(),TweenMax.delayedCall(1.4,function(){$("#app01").isSelected()})}function updateClock(){var a=new Date,b=("0"+a.getHours()).slice(-2),c=("0"+a.getMinutes()).slice(-2),d=b+":"+c;return $("#time").text(d),$(".ampm").css("right",$("#time").width()+20),setInterval(function(){var a=new Date,b=("0"+a.getHours()).slice(-2),c=("0"+a.getMinutes()).slice(-2),d=b+":"+c;$("#time").text(d),$(".ampm").css("right",$("#time").width()+20)},1e3),!0}function playWave(a){if(a){var b=$(".appbutton[data-number="+parseInt(stage)+"]"),c=b.attr("id").split("0")[1];filtering&&waveReseting&&(console.log("go"),waveReset=[!0,!0,!0,!0],waveReseting=!1),"all"!=filter_mode||waveReseting||(console.log("back"),waveReset=[!0,!0,!0,!0],waveReseting=!0),waveReset[c]?(console.log("play"),wave[2*c-2]=new TimelineMax({repeat:-1}),wave[2*c-1]=new TimelineMax({repeat:-1}),wave[2*c-2].fromTo($(".wave0"+c+"a"),3,{x:"0px"},{x:"-600px",perspective:1e3,force3D:!0,ease:Linear.easeNone}),wave[2*c-1].fromTo($(".wave0"+c+"b"),3.1,{x:"-100px"},{x:"-700px",perspective:1e3,force3D:!0,ease:Linear.easeNone}),waveReset[c]=!1):(console.log("resume"),null!=wave[2*c-2]&&wave[2*c-2].resume(),null!=wave[2*c-1]&&wave[2*c-1].resume())}else for(var d=0;6>d;d++)null!=wave[d]&&wave[d].pause()}function circle_transition(a,b){function c(){e=1920,f=1080,g=Math.sqrt(e/2*e/2+f*f)}var d=$("#tv"),e=0,f=0,g=0,h=1e3;c(),$(window).resize(c);var i=$("<div unselectable='on' id='circle'></div>"),j=a;h="rgba(0,0,0,0)"==j?200:1e3,d.append(i),i.css({"z-index":100,position:"absolute","background-color":j,width:0,height:0,"border-radius":"50%",left:"960px",top:"1080px","margin-left":0,"margin-top":0,"webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none"}),i.animate({width:2*g,height:2*g,"margin-left":-g,"margin-top":-g},{duration:h,easing:"easeOutCirc",queue:!1,complete:function(){b&&setTimeout(function(){i.animate({opacity:0},{duration:300,complete:function(){console.log($(this)),i.detach()}})},0)}})}function circle_transition_r(){function a(){b=$(window).width(),c=$(window).height(),d=Math.sqrt(b*b+c*c)}var b=($("#tv"),0),c=0,d=0;a(),$(window).resize(a);var e=$("#circle");e.animate({width:0,height:0,"margin-left":0,"margin-top":0},{duration:900,easing:"easeInCirc",queue:!1,complete:function(){setTimeout(function(){e.animate({opacity:0},{duration:300,complete:function(){console.log($(this)),e.detach()}})},0)}})}var mode="navigation",position=0,position_move=0,stage=1,level=1,folder_level=1,total_level=2,applistposition=1,appselected=0,apptotal=0,addfolder_stage=2,$backup,filter_mode="all",filtering=!1,waveReset=[!0,!0,!0,!0],waveReseting=!0,currentposition=0,filter_stage=1,rearrangelevel=1,rearrange_stage=1,rearrange_nav_stage=1,deletelist=["#cancel","#confirm"],delete_stage=1,colors={app01:"#d90070",app02:"#00cbb0",app03:"#0071d7",app04:"#56575c",app05:"#ED0E86",app06:"#ED0E86",app07:"#4A82EA",app08:"#8D1C9B",app09:"#01C7F1",app10:"#ED0E86",app11:"#ED0E86",app12:"#ED0E86"},pressed="#5eabd9",setting=["#search","#setting","#folder"],setting_stage=1,optionlist=["#rearrange","#rename","#remove"],option_stage=1,flag=!1,scale_speed=.3,slide_speed=.3,trans_speed=1.8,speed3=.4,filter_duration=300,count=$("#app > .appbutton").length,total=count,arrow_next=524+.5*(8-count)*160,arrow_prev=239+.5*(8-count)*160,isSelected_cardsize="300px",notSelected_cardsize="120px",origin_cardsize="300px",cardoffset=92,cardoffset1=30,tl1=new TimelineMax({repeat:-1}),tl2=new TimelineMax({repeat:-1}),wave=new TimelineMax({repeat:-1});$(document).ready(function(){function a(a){a=a||window.event;var b=400;if("undefined"!=typeof KeyEvent&&a.keyCode==KeyEvent.DOM_VK_SUBMENU&&flag&&1==level&&"navigation"==mode&&!filtering){mode="optionmode",option_stage=1,$("#option .optbutton").notSelected_option(.001),TweenLite.to($(".transition"),.001,{backgroundColor:"#000"}),flag=!1,$(".transition").transition_opening("optionmode");var c=$(".appbutton[data-number="+stage+"]");"folder"==c.attr("data-type")&&TweenLite.to($("#"+c.attr("id")+" > .appbutton-folder"),speed3,{opacity:0})}if("undefined"!=typeof KeyEvent?(a.keyCode==KeyEvent.DOM_VK_0&&(1==$(".hint").css("opacity")?$(".hint").css("opacity",0):$(".hint").css("opacity",1)),a.keyCode==KeyEvent.DOM_VK_1&&($(".hint1").css("opacity",1),$(".hint2").css("opacity",0),$(".hint3").css("opacity",0),$(".hintImg").css("opacity",0)),a.keyCode==KeyEvent.DOM_VK_2&&($(".hint1").css("opacity",0),$(".hint2").css("opacity",1),$(".hint3").css("opacity",0),$(".hintImg").css("opacity",1)),a.keyCode==KeyEvent.DOM_VK_3&&($(".hint1").css("opacity",0),$(".hint2").css("opacity",0),$(".hint3").css("opacity",1),$(".hintImg").css("opacity",1))):(48==a.keyCode&&(1==$(".hint").css("opacity")?$(".hint").css("opacity",0):$(".hint").css("opacity",1)),49==a.keyCode&&($(".hint1").css("opacity",1),$(".hint2").css("opacity",0),$(".hint3").css("opacity",0),$(".hintImg").css("opacity",0)),50==a.keyCode&&($(".hint1").css("opacity",0),$(".hint2").css("opacity",1),$(".hint3").css("opacity",0),$(".hintImg").css("opacity",1)),51==a.keyCode&&($(".hint1").css("opacity",0),$(".hint2").css("opacity",0),$(".hint3").css("opacity",1),$(".hintImg").css("opacity",1))),13==a.keyCode){if(flag)if("navigation"==mode){if(flag=!1,1==level)if("folder"!=$(".appbutton[data-number="+parseInt(stage)+"]").attr("data-type")){var d=$(".appbutton[data-number="+stage+"]").attr("id");TweenLite.to($(".transition"),.01,{backgroundColor:colors[d]}),TweenLite.to($("#dummy"),.01,{backgroundColor:colors[d]}),TweenLite.to($(".appbutton[data-number="+parseInt(stage)+"]"),scale_speed/2,{scaleX:1.3,scaleY:1.3,scaleZ:1.3,z:.001,perspective:1e3,force3D:!0,ease:Power1.easeInOut}),TweenLite.to($(".appbutton[data-number="+parseInt(stage)+"]"),scale_speed,{scaleX:1.6,scaleY:1.6,scaleZ:1.6,z:.001,perspective:1e3,force3D:!0,ease:Power1.easeInOut,delay:.08}),$(".dummycontent").css("background-image","url('../images/"+$(".appbutton[data-number="+parseInt(stage)+"]").attr("data-content")+"-dummy.jpg')"),$("#dummy p").text(""),"web"==$(".appbutton[data-number="+parseInt(stage)+"]").attr("data-filter")?circle_transition("#000",!0):circle_transition($(".appbutton[data-number="+parseInt(stage)+"]").css("background-color"),!0),TweenLite.to($(".appbutton[data-number="+parseInt(stage)+"]"),scale_speed,{scaleX:1,scaleY:1,scaleZ:1,z:.001,perspective:1e3,force3D:!0,zIndex:1,border:"0px #989898 solid",ease:Power1.easeIn,delay:1.5}),TweenLite.to($("#dummy"),1,{opacity:1,zIndex:100,ease:Power4.easeIn,delay:0,onComplete:function(){flag=!0,mode="dummymode",playWave(!1)}})}else flag=!0;else 3==level&&(flag=!0);if(0==level){if(1==setting_stage&&(console.log("search"),$("#search").addClass("pressed"),TweenLite.to($("#search"),.2,{backgroundColor:pressed,scaleX:1,scaleY:1,scaleZ:1,z:.001}),TweenMax.delayedCall(b/1e3,function(){$("#search").removeClass("pressed"),TweenLite.to($("#search"),.2,{backgroundColor:"#FFF",scaleX:1.1,scaleY:1.1,scaleZ:1.1,z:.001,onComplete:function(){circle_transition("#000",!0),$(".dummycontent").css("background-image","url('../images/Search.jpg')"),$("#dummy p").text(""),TweenLite.to($("#dummy"),1,{opacity:1,zIndex:100,ease:Power4.easeIn,delay:0,onComplete:function(){flag=!0,mode="dummymode",playWave(!1),$("#search").notSelected_setting()}})}})})),2==setting_stage&&(console.log("setting"),$("#setting").addClass("pressed"),TweenLite.to($("#setting"),.2,{backgroundColor:pressed,scaleX:1,scaleY:1,scaleZ:1,z:.001}),TweenMax.delayedCall(b/1e3,function(){$("#setting").removeClass("pressed"),TweenLite.to($("#setting"),.2,{backgroundColor:"#FFF",scaleX:1.1,scaleY:1.1,scaleZ:1.1,z:.001,onComplete:function(){circle_transition("rgba(0,0,0,0)",!0),$(".dummycontent").css("background-image","url('../images/Setting.png')"),$(".dummycontent").css("background-color","rgba(0,0,0,0)"),$("#dummy p").text(""),$("#dummy").css("background-color","rgba(0,0,0,0)"),TweenLite.to($("#dummy"),.4,{opacity:1,zIndex:100,ease:Power4.easeIn,delay:0,onComplete:function(){flag=!0,mode="dummymode",playWave(!1),$("#setting").notSelected_setting()}})}})})),3==setting_stage){console.log("add folder"),$("#folder").addClass("pressed"),TweenLite.to($("#folder"),.2,{backgroundColor:pressed,scaleX:1,scaleY:1,scaleZ:1,z:.001}),mode="addfolder";var e=$('#app .appbutton[data-type="card"]').length;$("#addfolder-number--total").text("/"+e),$('#addfolder .appbutton[data-type="card"]').remove(),$('#app .appbutton[data-type="card"]').clone().appendTo($("#addfolder")),$("#addfolder .appbutton").addClass("applist"),$(".applist").each(function(a){$(this).attr("data-number");$(this).attr("data-number","folder-card"+(a+1)),$(this).css({width:"190px",height:"190px",margin:"240px "+parseInt(155+240*a)+"px"})}),TweenLite.to($(".transition"),.001,{backgroundColor:"#000"}),TweenMax.delayedCall(.2,function(){$(".transition").transition_opening("addfolder")}),TweenMax.delayedCall(.3,function(){$("#folder").removeClass("pressed"),$("#folder").notSelected_setting()})}}else if(2==level){flag=!1,$(".filter-section li").eq(filter_stage-1).animate({textIndent:8},{step:function(a){$(this).css("-webkit-transform","scale("+a/10+")"),$(this).css("transform","scale("+a/10+")"),$(this).css("-moz-transform","scale("+a/10+")")},duration:100},"linear"),$(".filter-section li").eq(filter_stage-1).animate({textIndent:12},{step:function(a){$(this).css("-webkit-transform","scale("+a/10+")"),$(this).css("transform","scale("+a/10+")"),$(this).css("-moz-transform","scale("+a/10+")")},duration:200},"linear");var f=$(".filter-section li").eq(filter_stage-1).attr("data-filter");f!=filter_mode&&(TweenLite.to($("#filter .filtericon01"),.5,{backgroundPosition:"50% 335%",ease:Power4.easeOut}),$("#filter .filtericon02").css("background-image","url(../images/"+f+".svg)"),$(".filtericon02").removeClass("important-"+filter_mode),TweenLite.to($("#filter .filtericon02"),.5,{backgroundPosition:"50% 50%",ease:Power4.easeOut,onComplete:function(){$("#filter .filtericon02").css("background-position","50% -235%"),$("#filter .filtericon01").css("background-position","50% 50%"),$("#filter .filtericon01").css("background-image","url(../images/"+f+".svg)"),$(".filtericon01").removeClass("important-"+filter_mode)}})),waveReset=[!0,!0,!0,!0],TweenMax.delayedCall(.1,function(){$(".active").css("color","#ccc"),$(".active").removeClass("active"),$(".filter-section li").eq(filter_stage-1).addClass("active"),$("#app > .appbutton").closing();var a;a=1==count?700:1e3,TweenMax.delayedCall(a/1e3,function(){if("all"==f)filtering=!1,$(".next, .prev").css("display","block"),$("#app > .appbutton").length!=$backup.length&&($("#app > .appbutton").remove(),$("#app").append($backup),count=$backup.length),$("#app > .appbutton").opening(),filter_mode="all";else{filtering=!0,$("#app > .appbutton").remove(),$("#app").append($backup),$(".next, .prev").css("display","none"),filter_mode=f;var a=$('#app > .appbutton[data-filter="'+f+'"]').clone();count=a.length,a.each(function(a){$(this).attr("data-number",parseInt(a)+1),$(this).css("margin-left",(1920-300*count)/2+a*(300+100/count)-40)}),TweenMax.delayedCall(.2,function(){$("#app > .appbutton").remove(),$("#app").append(a),$("#app > .appbutton").css("left",0),$("#app > .appbutton").opening()})}})})}}else if("optionmode"==mode){if(flag=!1,1==option_stage){playWave(!1),console.log("rearrange"),stage==count?$(".next").css("display","none"):1==stage?$(".prev").css("display","none"):($(".next").css("display","block"),$(".prev").css("display","block")),currentposition=stage,$("#rearrange").addClass("pressed"),TweenLite.to($("#rearrange"),.2,{backgroundColor:pressed,scaleX:1,scaleY:1,scaleZ:1,z:.001}),$(".transition").transition_closing("rearrange"),TweenLite.to($("#black"),.5,{opacity:.4,zIndex:2e3,ease:Power1.easeInOut,delay:.5});var g=$(".appbutton");TweenLite.to(g,.8,{scaleX:.5,scaleY:.5,scaleZ:.5,z:.001,ease:Power4.easeInOut,perspective:1e3,force3D:!0,delay:.5}),position_move>0&&TweenLite.to($(".appbutton"),slide_speed,{left:"+="+319*position_move,perspective:1e3,force3D:!0,ease:Power1.easeInOut,delay:.5}),TweenMax.delayedCall(.5,function(){if(15>=count)for(var a=0;count>a;a++)TweenLite.to($(".appbutton[data-number="+(a+1)+"]"),.8,{marginLeft:(1920-150*count-10*(count-1))/2+160*a-75,perspective:1e3,force3D:!0,ease:Power4.easeInOut});else for(var a=0;count>a;a++)TweenLite.to($(".appbutton[data-number="+(a+1)+"]"),.8,{marginLeft:165+168*a,perspective:1e3,force3D:!0,ease:Power4.easeInOut});TweenMax.delayedCall(.7,function(){var a=$(".appbutton[data-number="+parseInt(stage)+"]");a.isSelected(.9);for(var b=0;3>b;b++)tl1[b]=new TimelineMax({repeat:-1,delay:.1*b}),tl2[b]=new TimelineMax({repeat:-1,delay:.1*b});var c=$(".next"),d=.6;c.each(function(a,b){tl1[a].fromTo(b,d,{left:arrow_next+160*(stage-1)+16*a+"px",opacity:0,ease:Power2.easeIn},{left:arrow_next+5+160*(stage-1)+16*a+"px",opacity:1,ease:Power2.easeIn}).to(b,d,{left:arrow_next+10+160*(stage-1)+16*a+"px",opacity:0,ease:Power2.easeOut})});var e=$(".prev");e.each(function(a,b){tl2[a].fromTo(b,d,{left:arrow_prev+160*(stage-1)-16*a+"px",opacity:0,ease:Power2.easeIn},{left:arrow_prev-5+160*(stage-1)-16*a+"px",opacity:1,ease:Power2.easeIn}).to(b,d,{left:arrow_prev-10+160*(stage-1)-16*a+"px",opacity:0,ease:Power2.easeOut})}),TweenLite.to($(".appbutton[data-number="+parseInt(stage)+"]"),.001,{zIndex:3e3}),$("#rearrange").removeClass("pressed"),TweenLite.to($("#rearrange"),.2,{backgroundColor:"#FFF"})})})}else if(2==option_stage)console.log("rename"),$("#rename").addClass("pressed"),TweenLite.to($("#rename"),.2,{backgroundColor:pressed,scaleX:1,scaleY:1,scaleZ:1,z:.001,perspective:1e3,force3D:!0}),TweenMax.delayedCall(b/1e3,function(){$("#rename").removeClass("pressed"),TweenLite.to($("#rename"),.2,{backgroundColor:"#FFF",scaleX:1.3,scaleY:1.3,scaleZ:1.3,z:.001,perspective:1e3,force3D:!0,onComplete:function(){flag=!0}})});else if(3==option_stage){console.log("remove"),$("#remove").addClass("pressed"),TweenLite.to($("#remove"),.2,{backgroundColor:pressed,scaleX:1,scaleY:1,scaleZ:1,z:.001,perspective:1e3,force3D:!0});var c=$(".appbutton[data-number="+parseInt(stage)+"]");if("folder"==c.attr("data-type"))mode="delete",console.log("Folder"),TweenLite.to($("#option .optbutton"),.8,{opacity:0,y:"+=100",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut,onComplete:function(){TweenLite.to($("#option"),.001,{zIndex:-1,ease:Power4.easeInOut}),TweenLite.to($("#delete .message"),.4,{opacity:1,ease:Power4.easeInOut}),TweenLite.to($("#delete"),.001,{zIndex:2e3,ease:Power4.easeInOut});var a=$("#delete .optbutton"),b=0;a.each(function(a,c){TweenMax.delayedCall(b/1e3,function(){TweenLite.to(c,.8,{opacity:1,y:"-=100",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut})}),b+=200}),TweenMax.delayedCall(1,function(){$("#cancel").isSelected_option(),TweenMax.delayedCall(.4,function(){$("#remove").removeClass("pressed")})})}});else{$(".transition").transition_closing("optionmode");var c=$(".appbutton[data-number="+parseInt(stage)+"]");TweenLite.to(c,.4,{y:"+=200",z:.001,opacity:0,perspective:1e3,force3D:!0,ease:Power2.easeInOut,delay:1,onComplete:function(){for(var a=parseInt(stage)+1;count>=a;a++){var b=$(".appbutton[data-number="+parseInt(a)+"]");b.attr("data-number",a-1),5>=count?1==stage?TweenLite.to(b,.4,{marginLeft:"-=162px",perspective:1e3,force3D:!0,ease:Power4.easeInOut}):TweenLite.to(b,.4,{marginLeft:"-=478px",perspective:1e3,force3D:!0,ease:Power4.easeInOut}):TweenLite.to(b,.4,{marginLeft:"-=320px",perspective:1e3,force3D:!0,ease:Power4.easeInOut,delay:.2})}TweenMax.delayedCall(.2,function(){1!=stage?($(".appbutton[data-number="+parseInt(stage-1)+"]").isSelected(),stage-=1,0==position_move?(position--,5>=count&&TweenLite.to($(".appbutton"),slide_speed,{marginLeft:"+=158",perspective:1e3,force3D:!0,ease:Power1.easeInOut})):position_move==count-5?(position_move--,TweenLite.to($(".appbutton"),slide_speed,{left:"+=319",perspective:1e3,force3D:!0,ease:Power1.easeInOut})):0!=position?position--:(position_move--,TweenLite.to($(".appbutton"),slide_speed,{left:"+=319",perspective:1e3,force3D:!0,ease:Power1.easeInOut}))):($(".appbutton[data-number="+parseInt(stage)+"]").isSelected(),$("#remove").removeClass("pressed")),c.remove(),count-=1,arrow_next=524+.5*(8-count)*160,arrow_prev=239+.5*(8-count)*160})}})}}}else if("rearrange"==mode){$(".appbutton[data-number="+parseInt(stage)+"]").notSelected(.5);var c=$(".appbutton[data-number="+parseInt(stage)+"]");$("#app > .appbutton").each(function(a,b){if("folder"==$(b).attr("data-type")){var c=$("#"+$(b).attr("id")+"> .appbutton-folder"),d=$(b).attr("data-number");c.each(function(a,b){var c=$(b).attr("data-number").split("-")[1];$(b).attr("data-number",d+"-"+c)})}}),$(".appbutton-folder").css("bottom","-250px"),TweenLite.to($(".next, .prev"),.001,{opacity:0,x:0,z:.001,perspective:1e3,force3D:!0});for(var h=0;3>h;h++)tl1[h].kill(),tl2[h].kill();TweenLite.to($("#black"),.5,{opacity:0,zIndex:-1,ease:Power1.easeInOut,delay:.3});var g=$(".appbutton");TweenLite.to(g,.8,{scale:1,ease:Power4.easeInOut,delay:.3}),TweenMax.delayedCall(.3,function(){if(5>=count)for(var a=0;count>a;a++)TweenLite.to($(".appbutton[data-number="+(a+1)+"]"),.8,{marginLeft:(1920-300*count)/2+a*(300+100/count)+10,perspective:1e3,force3D:!0,ease:Power4.easeInOut});else for(var a=0;count>a;a++)TweenLite.to($(".appbutton[data-number="+(a+1)+"]"),.8,{marginLeft:160+320*a+10,perspective:1e3,force3D:!0,ease:Power4.easeInOut});position=position>4?4:stage-1,stage>5?(TweenLite.to($(".appbutton"),slide_speed,{left:"-="+319*(stage-5),perspective:1e3,force3D:!0,ease:Power1.easeInOut,delay:.5}),position=4,position_move=stage-5):position_move=0,TweenMax.delayedCall(.7,function(){mode="navigation",$(".appbutton[data-number="+parseInt(stage)+"]").isSelected()})})}else if("delete"==mode)console.log("remove"),1==delete_stage?($("#cancel").addClass("pressed"),TweenLite.to($("#cancel"),.2,{backgroundColor:pressed,scaleX:1,scaleY:1,scaleZ:1,z:.001})):TweenLite.to($("#confirm"),.2,{scaleX:1,scaleY:1,scaleZ:1,z:.001,perspective:1e3,force3D:!0}),TweenLite.to($("#delete .message"),.8,{opacity:0,ease:Power4.easeInOut}),TweenLite.to($("#delete .optbutton"),.8,{opacity:0,y:"+=100",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut,onComplete:function(){option_stage=1,1==delete_stage?TweenMax.delayedCall(.6,function(){mode="navigation",$(".appbutton[data-number="+parseInt(stage)+"]").isSelected(),TweenMax.delayedCall(scale_speed,function(){$("#cancel").removeClass("pressed")})}):(console.log("confirm"),TweenMax.delayedCall(.2,function(){var a=$(".appbutton[data-number="+parseInt(stage)+"]"),b=$("#"+a.attr("id")+" > .appbutton-folder"),c=(b.length,b.clone());c.each(function(a){$(this).removeClass("appbutton-folder").addClass("appbutton").attr({"data-number":parseInt(count)+parseInt(a)+1,"data-type":"card"}),$(this).css({"margin-left":210+320*(parseInt(count)+parseInt(a))-40,left:-319*position_move,opacity:1}),TweenLite.to($("#"+$(this).attr("id")+" > p"),.3,{fontSize:"19pt",bottom:"50px",ease:Power2.easeInOut}),TweenLite.to(this,.001,{width:isSelected_cardsize,height:isSelected_cardsize,bottom:"0px",perspective:1e3,force3D:!0})}),$("#app").append(c),count+=b.length,TweenLite.to(a,.4,{y:"+=200",z:.001,opacity:0,perspective:1e3,force3D:!0,ease:Power2.easeInOut,onComplete:function(){for(var b=parseInt(stage)+1;count>=b;b++){var c=$(".appbutton[data-number="+parseInt(b)+"]");c.attr("data-number",b-1),console.log(c),5>=count?1==stage?TweenLite.to(c,.4,{marginLeft:"-=162px",perspective:1e3,force3D:!0,ease:Power4.easeInOut}):TweenLite.to(c,.4,{marginLeft:"-=478px",perspective:1e3,force3D:!0,ease:Power4.easeInOut}):TweenLite.to(c,.4,{marginLeft:"-=320px",perspective:1e3,force3D:!0,ease:Power4.easeInOut,delay:.2})}TweenMax.delayedCall(.2,function(){1!=stage?($(".appbutton[data-number="+parseInt(stage-1)+"]").isSelected(),stage-=1,0==position_move?(position--,5>=count&&TweenLite.to($(".appbutton"),slide_speed,{marginLeft:"+=158",perspective:1e3,force3D:!0,ease:Power1.easeInOut})):position_move==count-5?(position_move--,TweenLite.to($(".appbutton"),slide_speed,{left:"+=319",perspective:1e3,force3D:!0,ease:Power1.easeInOut})):0!=position?position--:(position_move--,TweenLite.to($(".appbutton"),slide_speed,{left:"+=319",perspective:1e3,force3D:!0,ease:Power1.easeInOut}))):$(".appbutton[data-number="+parseInt(stage)+"]").isSelected(),a.remove(),count-=1,mode="navigation",arrow_next=524+.5*(8-count)*160,arrow_prev=239+.5*(8-count)*160,delete_stage=1})}})})),$(".selectedOption").notSelected_option()}}),TweenLite.to($(".transition"),trans_speed-1,{opacity:0,perspective:1e3,force3D:!0,ease:Power4.easeIn,delay:.2,onComplete:function(){TweenLite.to($("#delete"),.001,{zIndex:-1,ease:Power4.easeInOut})}}),circle_transition_r();else if("addfolder"==mode)if(0==folder_level&&2==addfolder_stage)if($("#addfolder-done p").hasClass("inactive"))console.log("inactive");else{flag=!1;var i=0,j=[];console.log("done"),$("#addfolder-done p").addClass("pressed").css("color","#FFF"),TweenLite.to($("#addfolder-done"),.3,{scaleX:1,scaleY:1,scaleZ:1,z:.001,perspective:1e3,force3D:!0,background:"#5eabd9",onComplete:function(){TweenLite.to($(".transition"),trans_speed,{opacity:0,perspective:1e3,force3D:!0,ease:Power4.easeOut,delay:.3}),circle_transition_r();var a=[];$(".appselected").each(function(b){var c=$(this).attr("id");a[b]=$("#app > .appbutton#"+c).clone(),j.push(a[b].attr("data-number")),a[b].removeClass("appbutton").addClass("appbutton-folder"),a[b].attr("data-type","folder-card"),a[b].css({width:notSelected_cardsize,height:notSelected_cardsize,bottom:"-250px"}),$("#app > .appbutton#"+c).attr("data-number")<=stage&&i++,$("#app > .appbutton#"+c).remove(),count--}),console.log(j),$("#app > .appbutton").each(function(a){$(this).attr("data-number",parseInt(a)+1);for(var b=0;count>b;b++){var c=$("#app > .appbutton[data-number="+(b+1)+"]");c.css({"margin-left":210+320*b-40,left:-319*position_move})}}),TweenLite.to($("#addfolder"),.5,{opacity:0,zIndex:-1,onComplete:function(){for(var b=count;b>=parseInt(stage)+1-i;b--){var c=$(".appbutton[data-number="+parseInt(b)+"]");c.attr("data-number",parseInt(b)+1),TweenLite.to(c,.4,{marginLeft:"+=320px",perspective:1e3,force3D:!0,ease:Power4.easeInOut,delay:.2})}stage++,stage-=i,count++,total++,position++,position-=i,arrow_next=524+.5*(8-count)*160,arrow_prev=239+.5*(8-count)*160,position>=5&&(TweenLite.to($(".appbutton"),slide_speed,{left:"-=319",perspective:1e3,force3D:!0,ease:Power1.easeInOut,onComplete:function(){}}),position=4,position_move+=1);var d=$('.appbutton[data-type="folder"]').length;if(d++,1==stage){var e=$(".appbutton[data-number="+(stage+1)+"]");console.log(e),console.log("???"),e.before('<div class="appbutton" id="app'+pad(total,2)+'" data-type="folder" data-number="'+stage+'" data-content="My Folder'+d+'"><p>My Folder '+d+"</p>")}else{var e=$(".appbutton[data-number="+(stage-1)+"]");console.log(e),console.log("???"),e.after('<div class="appbutton" id="app'+pad(total,2)+'" data-type="folder" data-number="'+stage+'" data-content="My Folder'+d+'"><p>My Folder '+d+"</p>")}var e=$(".appbutton[data-number="+stage+"]");console.log(e);for(var b=0;b<a.length;b++)a[b].attr("data-number",stage+"-"+(parseInt(b)+1)),a[b].css({"margin-left":92+130*b,left:0}),e.append(a[b]);e.css("background-color","#5a5a5a"),e.css({"margin-left":210+320*(stage-1)-40,left:-319*position_move}),e.css("z-index",1),e.prepend('<span class="icon_folder"></span>'),TweenMax.delayedCall(.5,function(){TweenLite.fromTo(e,.4,{scale:0,opacity:0,perspective:1e3,force3D:!0},{scale:1.6,perspective:1e3,force3D:!0,border:"6px #FFF solid",opacity:1,y:"-=100",onComplete:function(){e.isSelected()}})}),mode="navigation",level=1,setting_stage=1,applistposition=1,appselected=0,$("#addfolder-number--selected").text(appselected),TweenLite.to($("#addfolder-done"),.01,{backgroundColor:"rgba(0,0,0,.8)"}),$("#addfolder-done p").removeClass("pressed"),$("#addfolder-done p").addClass("inactive").css("color","#aaa"),folder_level=1}})}})}else 1==folder_level&&(console.log("check app number "+applistposition),$(".applist").each(function(a){if(a==applistposition-1)if($(this).hasClass("appselected")){var b=$(this).attr("id");TweenLite.to($(this),.1,{backgroundColor:colors[b]}),$(this).removeClass("appselected"),appselected--}else TweenLite.to($(this),.1,{backgroundColor:"rgba(94,171,217,.9)"}),$(this).addClass("appselected"),appselected++}),$("#addfolder-number--selected").text(appselected),0!=appselected?$("#addfolder-done p").removeClass("inactive").css("color","#fff"):$("#addfolder-done p").addClass("inactive").css("color","#aaa"));else if("rearrange-folder"==mode){var c=$(".appbutton[data-number="+parseInt(stage)+'][data-type="folder"]');TweenLite.to($("#"+c.attr("id")+" > .appbutton-folder"),speed3,{opacity:0}),TweenLite.to($("#"+c.attr("id")+" p"),speed3,{opacity:1}),TweenLite.to($("#"+c.attr("id")+" .icon_folder"),speed3,{backgroundSize:"40% 40%"}),TweenLite.to($(".next, .prev"),.001,{opacity:0,x:0});for(var h=0;3>h;h++)tl1[h].kill(),tl2[h].kill();for(var k=$(".selected[data-number="+stage+"]"),l=$(".appbutton[data-number="+stage+'][data-type="folder"] > .appbutton-folder'),m=l.length+1,h=m-1;h>=rearrange_stage;h--)$(".appbutton-folder[data-number="+stage+"-"+h+"]").attr("data-number",stage+"-"+(h+1));var n=k.clone().removeClass("selected").removeClass("appbutton").addClass("appbutton-folder").attr("data-type","folder-card").css({opacity:0}).attr("data-number",stage+"-"+rearrange_stage),o=$(".appbutton[data-number="+stage+'][data-type="folder"]'),p=0;p=1==rearrangelevel?0:1,TweenLite.to(n,.001,{scaleX:1,scaleY:1,scaleZ:1,z:.001,zIndex:0,perspective:1e3,force3D:!0,x:"+=5px",y:"-="+235*p+"px",ease:Power4.easeInOut}),o.append(n),n.css({border:"0px"}),console.log(c.attr("id")),1==rearrangelevel?TweenLite.to(k,.8,{opacity:0,ease:Power4.easeInOut,delay:.3,onComplete:function(){k.remove()}}):TweenLite.to(k,speed3,{opacity:0,ease:Power4.easeInOut,onComplete:function(){TweenLite.to($(".next, .prev"),.3,{y:"-=230px",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut}),k.remove()}}),count--,rearrangelevel=1,rearrange_stage=1,arrow_next=524+.5*(8-count)*160,arrow_prev=239+.5*(8-count)*160,TweenLite.to($("#black"),.5,{opacity:0,zIndex:-1,ease:Power1.easeInOut,delay:.3});var g=$(".appbutton");TweenLite.to(g,.8,{scaleX:1,scaleY:1,scaleZ:1,z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut,delay:.3}),$(".appbutton-folder").each(function(){console.log($(this).css("margin-left")+"!0")}),TweenMax.delayedCall(.3,function(){if($("#"+c.attr("id")+" > .appbutton-folder").each(function(){var a=$(this).attr("data-number").split("-")[1]-1;console.log(a),$(this).css({width:notSelected_cardsize,height:notSelected_cardsize,"margin-left":92+130*a,left:0,bottom:"-250px"})}),$(".appbutton-folder").each(function(){console.log($(this).css("margin-left")+"!1")}),5>=count)for(var a=0;count>a;a++)TweenLite.to($(".appbutton[data-number="+(a+1)+"]"),.8,{marginLeft:(1920-300*count)/2+a*(300+100/count)-40,perspective:1e3,force3D:!0,ease:Power4.easeInOut});else for(var a=0;count>a;a++)TweenLite.to($(".appbutton[data-number="+(a+1)+"]"),.8,{marginLeft:160+320*a-40,perspective:1e3,force3D:!0,ease:Power4.easeInOut});$(".appbutton-folder").each(function(){console.log($(this).css("margin-left")+"!2")}),position=position>4?4:stage-1,stage>5?(TweenLite.to($(".appbutton"),slide_speed,{left:"-="+319*(stage-5),perspective:1e3,force3D:!0,ease:Power1.easeInOut,delay:.5}),position=4,position_move=stage-5):position_move=0,$(".appbutton-folder").each(function(){console.log($(this).css("margin-left")+"!3")}),TweenMax.delayedCall(.7,function(){mode="navigation",$(".appbutton[data-number="+parseInt(stage)+'][data-type="folder"]').isSelected(),$(".appbutton-folder").each(function(){console.log($(this).css("margin-left")+"?")})})})}}else if(8==a.keyCode||27==a.keyCode)flag&&(("optionmode"==mode||"dummymode"==mode||"addfolder"==mode)&&(flag=!1,$(".transition").transition_closing(mode)),"navigation"==mode&&1==level&&location.reload());else if(38==a.keyCode){if(console.log("up"),playWave(!1),flag)if("navigation"==mode){var q=$(".appbutton[data-number="+parseInt(stage)+"]");1==level?(flag=!1,q.notSelected(),$("#search").isSelected_setting(),level--):2==level?(flag=!1,$("#filter").notSelected_setting(),q.isSelected(),level--):3==level&&(flag=!1,rearrange_nav_stage=1,$(".cardselected").notSelected(),$(".cardselected").removeClass("cardselected"),TweenLite.to($("#app > .appbutton"),.3,{y:"+=185px",perspective:1e3,force3D:!0,ease:Power2.easeInOut}),$("#"+q.attr("id")+" > .appbutton-folder").each(function(){var a=(parseInt($(this).css("margin-left").split("p")[0])+230)/2.5+"px";TweenLite.to($("#"+$(this).attr("id")+" > p"),.3,{fontSize:"12pt",bottom:"20px",ease:Power2.easeInOut}),$(this).removeClass("focus"),TweenLite.to(this,.3,{width:notSelected_cardsize,height:notSelected_cardsize,bottom:"-250px",z:.001,perspective:1e3,force3D:!0,marginLeft:a,ease:Power2.easeInOut})}),TweenLite.to(q,.3,{scaleX:1.6,scaleY:1.6,scaleZ:1.6,zIndex:10,z:.001,perspective:1e3,force3D:!0,border:"6px #FFF solid",ease:Power4.easeInOut,onComplete:function(){flag=!0}}),level=1)}else if("addfolder"==mode)total_level=1+$(".applist").length/8,0!=folder_level&&(flag=!1,folder_level--,$(".selected").notSelected(),$("#addfolder-done p").hasClass("inactive")||TweenLite.to($("#addfolder-done p"),.3,{color:"#000"}),TweenLite.to($("#addfolder-done"),.3,{scaleX:1,scaleY:1,scaleZ:1,z:.001,perspective:1e3,force3D:!0,backgroundColor:"rgba(255,255,255,1)",onComplete:function(){flag=!0}}));else if("rearrange-folder"==mode&&2==rearrangelevel&&1==rearrange_stage){flag=!1,rearrangelevel=1;var c=$(".selected[data-number="+stage+"]");TweenLite.to(c,speed3,{y:"-=235px",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut});var r=$(".appbutton[data-number="+stage+"] > .appbutton-folder");TweenLite.to(r,speed3,{marginLeft:"-=160px",perspective:1e3,force3D:!0,ease:Power4.easeInOut,onComplete:function(){flag=!0}}),TweenLite.to($(".next, .prev"),.3,{y:"-=235px",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut}),stage==count?$(".next").css("display","none"):1==stage?$(".prev").css("display","none"):($(".next").css("display","block"),$(".prev").css("display","block"))}}else if(40==a.keyCode){if(console.log("down"),playWave(!1),flag)if("navigation"==mode){var q=$(".appbutton[data-number="+parseInt(stage)+"]");if(1==level)if(flag=!1,"folder"==q.attr("data-type")){var l=$('.appbutton-folder[data-number="'+stage+'-1"]');TweenLite.to($("#app > .appbutton"),.3,{y:"-=185px",perspective:1e3,force3D:!0,ease:Power2.easeInOut}),$("#"+q.attr("id")+" > .appbutton-folder").each(function(){TweenLite.to($("#"+$(this).attr("id")+" > p"),.3,{fontSize:"19pt",bottom:"50px",ease:Power2.easeInOut});var a=2.5*$(this).css("margin-left").split("p")[0]-230+"px";$(this).addClass("focus"),TweenLite.to(this,.3,{width:origin_cardsize,height:origin_cardsize,bottom:"-450px",
z:.001,perspective:1e3,force3D:!0,marginLeft:a,ease:Power2.easeInOut})}),l.addClass("cardselected"),l.isSelected(),TweenLite.to(q,.3,{scaleX:1,scaleY:1,scaleZ:1,zIndex:1,z:.001,perspective:1e3,force3D:!0,border:"0px #FFF solid",ease:Power4.easeInOut}),level=3}else q.notSelected(),$("#filter").isSelected_setting(),level++;else 0==level?(flag=!1,$(".selected").notSelected_setting(),q.isSelected(),level++,setting_stage=1):3==level&&(flag=!1,$(".cardselected").notSelected(),$(".cardselected").removeClass("cardselected"),TweenLite.to($("#app > .appbutton"),.3,{y:"+=185px",perspective:1e3,force3D:!0,ease:Power2.easeInOut}),$("#"+q.attr("id")+" > .appbutton-folder").each(function(){TweenLite.to($("#"+$(this).attr("id")+" > p"),.3,{fontSize:"12pt",bottom:"20px",ease:Power2.easeInOut});var a=(parseInt($(this).css("margin-left").split("p")[0])+230)/2.5+"px";TweenLite.to(this,.3,{width:notSelected_cardsize,height:notSelected_cardsize,bottom:"-250px",z:.001,perspective:1e3,force3D:!0,marginLeft:a,ease:Power2.easeInOut}),$(this).removeClass("focus")}),q.notSelected(),rearrange_nav_stage=1,$("#filter").isSelected_setting(),level=2)}else if("addfolder"==mode)total_level=1+parseInt($(".applist").length/8),folder_level!=total_level&&(flag=!1,folder_level++,addfolder_stage=2,$('.applist[data-number="folder-card'+applistposition+'"]').isSelected(1.5),TweenLite.to($("#addfolder-name p"),.3,{z:.001,perspective:1e3,force3D:!0,backgroundColor:"rgba(0,0,0,0)"}),TweenLite.to($("#addfolder-name"),.3,{z:.001,perspective:1e3,force3D:!0,borderBottomColor:"#fff",borderWidth:"2px"}),TweenLite.to($("#keyboard"),.6,{z:.001,perspective:1e3,force3D:!0,bottom:"-50%",ease:Power4.easeInOut}),TweenLite.to($("#close"),.3,{opacity:0}),$("#addfolder-done p").hasClass("inactive")||TweenLite.to($("#addfolder-done p"),.3,{color:"#fff"}),TweenLite.to($("#addfolder-done"),.3,{scaleX:1,scaleY:1,scaleZ:1,z:.001,perspective:1e3,force3D:!0,backgroundColor:"rgba(0,0,0,.8)",onComplete:function(){flag=!0}}));else if("rearrange-folder"==mode&&1==rearrangelevel){flag=!1,rearrangelevel=2;var c=$(".selected[data-number="+stage+"]");TweenLite.to(c,speed3,{y:"+=235px",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut});var r=$(".appbutton[data-number="+stage+"] > .appbutton-folder");TweenLite.to(r,speed3,{marginLeft:"+=160px",perspective:1e3,force3D:!0,ease:Power4.easeInOut,onComplete:function(){flag=!0}}),TweenLite.to($(".next, .prev"),.3,{y:"+=235px",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut}),$(".prev").css("display","none")}}else if(37==a.keyCode){if(console.log("left"),flag)if("rearrange"==mode){if(1!=currentposition){flag=!1;var c=$(".selected"),s=c.findNext("left");if("card"==c.attr("data-type")&&"folder"==s.attr("data-type")){mode="rearrange-folder",TweenLite.to($("#"+s.attr("id")+" > p"),speed3,{opacity:0}),TweenLite.to($("#"+s.attr("id")+" .icon_folder"),speed3,{backgroundSize:"80% 80%"}),stage--,currentposition--,c=$('#app > .appbutton[data-number="'+stage+'"]');for(var h=parseInt(stage)+1;count>=h;h++){var r=$(".appbutton[data-number="+parseInt(h)+"]");r.attr("data-number",parseInt(h)-1)}if(15>=count)for(var h=0;count-1>h;h++)TweenLite.to($(".appbutton[data-number="+(h+1)+"]"),speed3,{marginLeft:(1920-150*(count-1)-10*(count-2))/2+160*h-75,perspective:1e3,force3D:!0,ease:Power4.easeInOut});else for(var h=0;count-1>h;h++)TweenLite.to($(".appbutton[data-number="+(h+1)+"]"),speed3,{marginLeft:165+168*h,perspective:1e3,force3D:!0,ease:Power4.easeInOut});$("#"+s.attr("id")+" > .appbutton-folder").each(function(){var a=$(this).attr("data-number").split("-")[1]-1;TweenLite.to(this,speed3,{opacity:1,width:"180px",height:"180px",marginLeft:"+="+(-30+60*a)+"px",bottom:"-300px",perspective:1e3,force3D:!0})}),TweenLite.to(c,speed3,{scaleX:.65,scaleY:.65,scaleZ:.65,z:.001,perspective:1e3,force3D:!0,x:"-=5px",z:.001,ease:Power4.easeInOut}),TweenLite.to(s,speed3,{scaleX:.9,scaleY:.9,scaleZ:.9,z:.001,perspective:1e3,force3D:!0,zIndex:2999,ease:Power4.easeInOut,onComplete:function(){flag=!0}}),TweenLite.to($(".next, .prev"),speed3,{x:"-=80px",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut})}else{stage--;var t=c.css("margin-left"),u=s.css("margin-left");c.moveUp(),TweenLite.to(c,.2,{marginLeft:u,ease:Power4.easeInOut,onComplete:function(){flag=!0}}),TweenLite.to(s,.2,{marginLeft:t,ease:Power4.easeInOut,onComplete:function(){flag=!0}}),currentposition--,TweenLite.to($(".next, .prev"),.2,{x:"-=160px",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut})}}currentposition==count?$(".next").css("display","none"):1==currentposition?$(".prev").css("display","none"):($(".next").css("display","block"),$(".prev").css("display","block"))}else if("rearrange-folder"==mode){if(1==rearrangelevel){flag=!1,mode="rearrange",c=$(".selected[data-number="+stage+"]"),c.moveUp();for(var v=count-1;v>=parseInt(stage);v--){var r=$("#app > .appbutton[data-number="+parseInt(v)+"]");r.attr("data-number",parseInt(v)+1)}if($(".selected").attr("data-number",stage),15>=count)for(var h=0;count>h;h++)TweenLite.to($(".appbutton[data-number="+(h+1)+"]"),speed3,{marginLeft:(1920-150*count-10*(count-1))/2+160*h-75,perspective:1e3,force3D:!0,ease:Power4.easeInOut});else for(var h=0;count-1>h;h++)TweenLite.to($(".appbutton[data-number="+(h+1)+"]"),speed3,{marginLeft:165+168*h,perspective:1e3,force3D:!0,ease:Power4.easeInOut});var w=parseInt(stage)+1;s=$(".appbutton[data-number="+w+"]"),TweenLite.to($("#"+s.attr("id")+" > p"),speed3,{opacity:1}),TweenLite.to($("#"+s.attr("id")+" .icon_folder"),speed3,{backgroundSize:"40% 40%"}),$("#"+s.attr("id")+" > .appbutton-folder").each(function(){var a=$(this).attr("data-number").split("-")[1]-1;TweenLite.to(this,speed3,{opacity:0,width:notSelected_cardsize,height:notSelected_cardsize,marginLeft:"-="+(-30+60*a)+"px",bottom:"-300px",perspective:1e3,force3D:!0})}),TweenLite.to(c,speed3,{scaleX:.9,scaleY:.9,scaleZ:.9,z:.001,perspective:1e3,force3D:!0,x:0,ease:Power4.easeInOut}),TweenLite.to(s,speed3,{scaleX:.5,scaleY:.5,scaleZ:.5,z:.001,perspective:1e3,force3D:!0,zIndex:1,ease:Power4.easeInOut,onComplete:function(){flag=!0}}),TweenLite.to($(".next, .prev"),speed3,{x:"-=80px",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut})}else if(2==rearrangelevel){var l=$(".appbutton[data-number="+stage+'][data-type="folder"] > .appbutton-folder'),m=l.length+1,c=$(".selected[data-number="+stage+"]");if(1!=rearrange_stage){flag=!1;var t=c.css("margin-left"),u=$('.appbutton-folder[data-number="'+stage+"-"+(rearrange_stage-1)+'"]').css("margin-left");TweenLite.to(c,speed3,{marginLeft:"-=160px",perspective:1e3,force3D:!0,ease:Power4.easeInOut}),TweenLite.to($('.appbutton-folder[data-number="'+stage+"-"+(rearrange_stage-1)+'"]'),speed3,{marginLeft:"+=160px",perspective:1e3,force3D:!0,ease:Power4.easeInOut,onComplete:function(){flag=!0}}),rearrange_stage--,TweenLite.to($(".next, .prev"),.3,{x:"-=160px",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut}),rearrange_stage==m?$(".next").css("display","none"):1==rearrange_stage?$(".prev").css("display","none"):($(".next").css("display","block"),$(".prev").css("display","block"))}}}else if("navigation"==mode){if(1==level)1!=stage&&(playWave(!1),flag=!1,stage--,position--,0>position&&(flag=!1,TweenLite.to($(".appbutton"),slide_speed,{left:"+=319",perspective:1e3,force3D:!0,ease:Power1.easeInOut,onComplete:function(){}}),position=0,position_move-=1),$(".appbutton[data-number="+parseInt(stage)+"]").isSelected(),$(".appbutton[data-number="+parseInt(stage+1)+"]").notSelected());else if(0==level)setting_stage>1&&(flag=!1,$(setting[setting_stage-1]).notSelected_setting(),$(setting[setting_stage-2]).isSelected_setting(),setting_stage--);else if(2==level){var x=$(".filter-section li").length;1!=filter_stage&&($(".filter-section li").eq(filter_stage-1).animate({textIndent:10},{step:function(a){$(this).css("-webkit-transform","scale("+a/10+")"),$(this).css("transform","scale("+a/10+")"),$(this).css("-moz-transform","scale("+a/10+")"),$(this).hasClass("active")||$(this).css("color","#CCC")},duration:filter_duration},"linear"),$(".filter-section li").eq(filter_stage-2).animate({textIndent:12},{step:function(a){$(this).css("-webkit-transform","scale("+a/10+")"),$(this).css("transform","scale("+a/10+")"),$(this).css("-moz-transform","scale("+a/10+")"),$(this).hasClass("active")||$(this).css("color","#FFF")},duration:filter_duration},"linear"),filter_stage--)}else if(3==level){var y=$(".appbutton[data-number="+parseInt(stage)+"] > .appbutton-folder").length;if(rearrange_nav_stage>1){flag=!1,$(".cardselected").notSelected(),$(".cardselected").removeClass("cardselected");var l=$('.appbutton-folder[data-number="'+stage+"-"+(parseInt(rearrange_nav_stage)-1)+'"]');l.addClass("cardselected"),l.isSelected(),rearrange_nav_stage--}}}else if("optionmode"==mode){var c=$(".appbutton[data-number="+parseInt(stage)+"]");option_stage>1&&"main"!=c.attr("data-type")&&(flag=!1,$(optionlist[option_stage-1]).notSelected_option(),$(optionlist[option_stage-2]).isSelected_option(),option_stage--)}else"delete"==mode?delete_stage>1&&(flag=!1,TweenLite.to($(deletelist[delete_stage-1]),.4,{scaleX:1,scaleY:1,scaleZ:1,z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut,perspective:1e3}),$(deletelist[delete_stage-2]).isSelected_option(),delete_stage--):"addfolder"==mode&&(1==folder_level?applistposition>1&&(applistposition--,$('.applist[data-number="folder-card'+(applistposition+1)+'"]').notSelected(),$('.applist[data-number="folder-card'+applistposition+'"]').isSelected(1.5)):0==folder_level&&2==addfolder_stage&&(addfolder_stage--,flag=!1,TweenLite.to($("#addfolder-name p"),.3,{z:.001,perspective:1e3,force3D:!0,backgroundColor:"#4B788C"}),TweenLite.to($("#addfolder-name"),.3,{z:.001,perspective:1e3,force3D:!0,borderBottomColor:"#5eabd9",borderWidth:"4px"}),TweenLite.to($("#keyboard"),.6,{z:.001,perspective:1e3,force3D:!0,bottom:"0",ease:Power4.easeInOut}),TweenLite.to($("#close"),.3,{opacity:1}),$("#addfolder-done p").hasClass("inactive")||TweenLite.to($("#addfolder-done p"),.3,{color:"#FFF"}),TweenLite.to($("#addfolder-done"),.3,{scaleX:1,scaleY:1,scaleZ:1,z:.001,perspective:1e3,force3D:!0,backgroundColor:"rgba(0,0,0,.8)",onComplete:function(){flag=!0}})))}else if(39==a.keyCode&&(console.log("right"),flag))if("rearrange"==mode){if(currentposition!=count){flag=!1;var c=$(".selected"),s=c.findNext("right");if("card"==c.attr("data-type")&&"folder"==s.attr("data-type")){mode="rearrange-folder",TweenLite.to($("#"+s.attr("id")+" > p"),speed3,{opacity:0}),TweenLite.to($("#"+s.attr("id")+" .icon_folder"),speed3,{backgroundSize:"80% 80%"});for(var h=parseInt(stage)+1;count>=h;h++){var r=$(".appbutton[data-number="+parseInt(h)+"]");r.attr("data-number",parseInt(h)-1)}if(15>=count)for(var h=0;count-1>h;h++)TweenLite.to($(".appbutton[data-number="+(h+1)+"]"),speed3,{marginLeft:(1920-150*(count-1)-10*(count-2))/2+160*h-75,perspective:1e3,force3D:!0,ease:Power4.easeInOut});else for(var h=0;count-1>h;h++)TweenLite.to($(".appbutton[data-number="+(h+1)+"]"),speed3,{marginLeft:165+168*h,perspective:1e3,force3D:!0,ease:Power4.easeInOut});$("#"+s.attr("id")+" > .appbutton-folder").each(function(){var a=$(this).attr("data-number").split("-")[1]-1;$(this).attr("data-number",stage+"-"+(a+1)),TweenLite.to(this,speed3,{opacity:1,width:"180px",height:"180px",marginLeft:"+="+(-30+60*a)+"px",bottom:"-300px",perspective:1e3,force3D:!0})}),TweenLite.to(c,speed3,{scaleX:.65,scaleY:.65,scaleZ:.65,z:.001,perspective:1e3,force3D:!0,x:"-=5px",ease:Power4.easeInOut}),TweenLite.to(s,speed3,{scaleX:.9,scaleY:.9,scaleZ:.9,z:.001,perspective:1e3,force3D:!0,zIndex:2999,ease:Power4.easeInOut,onComplete:function(){flag=!0}}),TweenLite.to($(".next, .prev"),speed3,{x:"+=80px",z:.001,ease:Power4.easeInOut})}else{stage++;var t=c.css("margin-left"),u=s.css("margin-left");c.moveDown(),TweenLite.to(c,.2,{marginLeft:u,ease:Power4.easeInOut,onComplete:function(){flag=!0}}),TweenLite.to(s,.2,{marginLeft:t,ease:Power4.easeInOut,onComplete:function(){flag=!0}}),currentposition++,TweenLite.to($(".next, .prev"),.2,{x:"+=160px",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut})}}currentposition==count?$(".next").css("display","none"):1==currentposition?$(".prev").css("display","none"):($(".next").css("display","block"),$(".prev").css("display","block"))}else if("rearrange-folder"==mode){if(1==rearrangelevel){mode="rearrange",flag=!1,c=$(".selected[data-number="+stage+"]"),c.moveDown();for(var v=count-1;v>=parseInt(stage)+1;v--){var r=$("#app > .appbutton[data-number="+parseInt(v)+"]");r.attr("data-number",parseInt(v)+1)}if(stage++,$(".selected").attr("data-number",stage),15>=count)for(var h=0;count>h;h++)TweenLite.to($(".appbutton[data-number="+(h+1)+"]"),speed3,{marginLeft:(1920-150*count-10*(count-1))/2+160*h-75,perspective:1e3,force3D:!0,ease:Power4.easeInOut});else for(var h=0;count-1>h;h++)TweenLite.to($(".appbutton[data-number="+(h+1)+"]"),speed3,{marginLeft:165+168*h,perspective:1e3,force3D:!0,ease:Power4.easeInOut});var w=parseInt(stage)-1;s=$(".appbutton[data-number="+w+"]"),TweenLite.to($("#"+s.attr("id")+" > p"),speed3,{opacity:1}),TweenLite.to($("#"+s.attr("id")+" .icon_folder"),speed3,{backgroundSize:"40% 40%"}),$("#"+s.attr("id")+" > .appbutton-folder").each(function(){var a=$(this).attr("data-number").split("-")[1]-1;TweenLite.to(this,speed3,{opacity:0,width:notSelected_cardsize,height:notSelected_cardsize,marginLeft:"-="+(-30+60*a)+"px",bottom:"-300px"})}),TweenLite.to(c,speed3,{scaleX:.9,scaleY:.9,scaleZ:.9,z:.001,perspective:1e3,force3D:!0,x:0,ease:Power4.easeInOut}),TweenLite.to(s,speed3,{scaleX:.5,scaleY:.5,scaleZ:.5,z:.001,perspective:1e3,force3D:!0,zIndex:1,ease:Power4.easeInOut,onComplete:function(){flag=!0}}),currentposition++,TweenLite.to($(".next, .prev"),speed3,{x:"+=80px",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut})}else if(2==rearrangelevel){var l=$(".appbutton[data-number="+stage+'][data-type="folder"] > .appbutton-folder'),m=l.length+1,c=$(".selected[data-number="+stage+"]");if(rearrange_stage!=m){flag=!1;var t=c.css("margin-left"),u=$('.appbutton-folder[data-number="'+stage+"-"+rearrange_stage+'"]').css("margin-left");TweenLite.to(c,speed3,{marginLeft:"+=160px",perspective:1e3,force3D:!0,ease:Power4.easeInOut}),TweenLite.to($('.appbutton-folder[data-number="'+stage+"-"+rearrange_stage+'"]'),speed3,{marginLeft:"-=160px",perspective:1e3,force3D:!0,ease:Power4.easeInOut,onComplete:function(){flag=!0}}),rearrange_stage++,TweenLite.to($(".next, .prev"),.3,{x:"+=160px",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut}),rearrange_stage==m?$(".next").css("display","none"):1==rearrange_stage?$(".prev").css("display","none"):($(".next").css("display","block"),$(".prev").css("display","block"))}}}else if("navigation"==mode){if(1==level)stage!=count&&(playWave(!1),flag=!1,stage++,position++,position>=5&&(flag=!1,TweenLite.to($(".appbutton"),slide_speed,{left:"-=319",perspective:1e3,force3D:!0,ease:Power1.easeInOut,onComplete:function(){}}),position=4,position_move+=1),$(".appbutton[data-number="+parseInt(stage)+"]").isSelected(),$(".appbutton[data-number="+parseInt(stage-1)+"]").notSelected());else if(0==level)3>setting_stage&&(flag=!1,$(setting[setting_stage-1]).notSelected_setting(),$(setting[setting_stage]).isSelected_setting(),setting_stage++);else if(2==level){var x=$(".filter-section li").length;filter_stage!=x&&($(".filter-section li").eq(filter_stage-1).animate({textIndent:10},{step:function(a){$(this).css("-webkit-transform","scale("+a/10+")"),$(this).css("transform","scale("+a/10+")"),$(this).css("-moz-transform","scale("+a/10+")"),$(this).hasClass("active")||$(this).css("color","#CCC")},duration:filter_duration},"linear"),$(".filter-section li").eq(filter_stage).animate({textIndent:12},{step:function(a){$(this).css("-webkit-transform","scale("+a/10+")"),$(this).css("transform","scale("+a/10+")"),$(this).css("-moz-transform","scale("+a/10+")"),$(this).hasClass("active")||$(this).css("color","#FFF")},duration:filter_duration},"linear"),filter_stage++)}else if(3==level){var y=$(".appbutton[data-number="+parseInt(stage)+"] > .appbutton-folder").length;if(y>rearrange_nav_stage){flag=!1,$(".cardselected").notSelected(),$(".cardselected").removeClass("cardselected");var l=$('.appbutton-folder[data-number="'+stage+"-"+(parseInt(rearrange_nav_stage)+1)+'"]');l.addClass("cardselected"),l.isSelected(),rearrange_nav_stage++}}}else if("optionmode"==mode){var c=$(".appbutton[data-number="+parseInt(stage)+"]");3>option_stage&&"main"!=c.attr("data-type")&&(flag=!1,$(optionlist[option_stage-1]).notSelected_option(),$(optionlist[option_stage]).isSelected_option(),option_stage++)}else"delete"==mode?2>delete_stage&&(flag=!1,$(deletelist[delete_stage-1]).notSelected_option(),TweenLite.to($(deletelist[delete_stage]),speed3,{scaleX:1.3,scaleY:1.3,scaleZ:1.3,z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut,perspective:1e3,onComplete:function(){flag=!0}}),delete_stage++):"addfolder"==mode&&(1==folder_level?applistposition!=$(".applist").length&&(applistposition++,$('.applist[data-number="folder-card'+(applistposition-1)+'"]').notSelected(),$('.applist[data-number="folder-card'+applistposition+'"]').isSelected(1.5)):0==folder_level&&1==addfolder_stage&&(flag=!1,addfolder_stage++,TweenLite.to($("#addfolder-name p"),.3,{z:.001,perspective:1e3,force3D:!0,backgroundColor:"rgba(0,0,0,0)"}),TweenLite.to($("#addfolder-name"),.3,{z:.001,perspective:1e3,force3D:!0,borderBottomColor:"#fff",borderWidth:"2px"}),TweenLite.to($("#keyboard"),.6,{z:.001,perspective:1e3,force3D:!0,bottom:"-50%",ease:Power4.easeInOut}),TweenLite.to($("#close"),.3,{opacity:0}),$("#addfolder-done p").hasClass("inactive")||TweenLite.to($("#addfolder-done p"),.3,{color:"#000"}),TweenLite.to($("#addfolder-done"),.3,{scaleX:1,scaleY:1,scaleZ:1,z:.001,perspective:1e3,force3D:!0,backgroundColor:"rgba(255,255,255,1)",onComplete:function(){flag=!0}})))}initSmartHome(),$(window).keydown(function(a){if(a.altKey&&flag&&1==level&&"navigation"==mode&&!filtering){mode="optionmode",option_stage=1,$("#option .optbutton").notSelected_option(.001),TweenLite.to($(".transition"),.001,{backgroundColor:"#000"}),flag=!1,$(".transition").transition_opening("optionmode");var b=$(".appbutton[data-number="+stage+"]");"folder"==b.attr("data-type")&&TweenLite.to($("#"+b.attr("id")+" > .appbutton-folder"),speed3,{opacity:0})}65==a.keyCode&&(console.log("stage="+stage+" currentposition="+currentposition+" rearrangestage="+rearrange_stage),console.log(waveReset))}),document.onkeydown=a}),function(a){a.fn.opening=function(){var b=100;return a(this).each(function(a,c){TweenMax.delayedCall(b/1e3,function(){TweenLite.to(c,.8,{opacity:1,y:"-=100",z:.001,ease:Power4.easeInOut,perspective:1e3,force3D:!0})}),b+=140}),2==level&&(flag=!0),this}}(jQuery),function(a){a.fn.closing=function(){var b=100;return a(this).each(function(a,c){TweenMax.delayedCall(b/1e3,function(){TweenLite.to(c,.8,{opacity:0,y:"+=100",z:.001,ease:Power4.easeInOut,perspective:1e3,force3D:!0})}),b+=80}),position_move>0?(TweenLite.to(a(".appbutton"),slide_speed,{left:"+="+319*position_move,ease:Power1.easeInOut,perspective:1e3,force3D:!0,onComplete:function(){$backup=a("#app > .appbutton").clone(),TweenLite.to($backup,.001,{opacity:0,y:0,z:.001,ease:Power4.easeInOut,perspective:1e3,force3D:!0})}}),position=0,position_move=0,stage=1):"all"==filter_mode&&($backup=a("#app > .appbutton").clone(),TweenLite.to($backup,.001,{opacity:0,y:0,z:.001,ease:Power4.easeInOut,perspective:1e3,force3D:!0})),this}}(jQuery),function(a){a.fn.isSelected=function(b){if(b=b||1.6,this.hasClass("cardselected")?TweenLite.to(this,scale_speed,{border:"6px #FFF solid",borderTop:"6px #FFF solid",borderBottom:"6px #FFF solid",borderLeft:"6px #FFF solid",borderRight:"6px #FFF solid",scaleX:1.6,scaleY:1.6,scaleZ:1.6,z:.001,zIndex:10,perspective:1e3,force3D:!0,ease:Power4.easeInOut,perspective:1e3,onComplete:function(){flag=!0}}):TweenLite.to(this,scale_speed,{scaleX:b,scaleY:b,scaleZ:b,z:.001,zIndex:10,border:"6px #FFF solid",ease:Power4.easeInOut,perspective:1e3,force3D:!0,perspective:1e3,onComplete:function(){flag=!0}}),this.addClass("selected"),"navigation"==mode){var c=a(this).attr("id");TweenLite.to(a("#"+c+" > .appbutton-folder"),speed3,{opacity:1}),playWave(!0)}return this}}(jQuery),function(a){a.fn.notSelected=function(b){if(b=b||1,"navigation"==mode){var c=a(this).attr("id");TweenLite.to(a("#"+c+" > .appbutton-folder"),speed3,{opacity:0})}return this.hasClass("cardselected")?TweenLite.to(this,scale_speed,{border:"0px #FFF solid",borderTop:"0px #FFF solid",borderBottom:"0px #FFF solid",borderLeft:"0px #FFF solid",borderRight:"0px #FFF solid",scaleX:1,scaleY:1,scaleZ:1,z:.001,zIndex:1,perspective:1e3,force3D:!0,ease:Power4.easeInOut,onComplete:function(){}}):TweenLite.to(this,scale_speed,{scaleX:b,scaleY:b,scaleZ:b,z:.001,zIndex:0,border:"0px #989898 solid",ease:Power4.easeInOut,perspective:1e3,force3D:!0,onComplete:function(){}}),this.removeClass("selected"),this}}(jQuery),function(a){a.fn.isSelected_setting=function(){if("filter"==this.attr("id")){var b=this;b.addClass("selected"),a("#filter.navbutton.selected .filtericon01").addClass("important-"+filter_mode),TweenLite.to(this,.3,{scaleX:1.1,scaleY:1.1,scaleZ:1.1,z:.001,backgroundColor:"rgba(255,255,255,1)",perspective:1e3,force3D:!0,ease:Power2.easeInOut,perspective:1e3,onComplete:function(){}}),TweenMax.delayedCall(.3,function(){b.removeClass("selected")}),TweenLite.to(this,.3,{scaleX:1,scaleY:1,scaleZ:1,z:.001,backgroundColor:"rgba(0,0,0,.5)",delay:.3,perspective:1e3,force3D:!0,ease:Power2.easeInOut,perspective:1e3,onComplete:function(){TweenLite.to(a(".filter-section"),.01,{opacity:1}),TweenLite.to(a(".filter-section"),1,{width:"840px",perspective:1e3,force3D:!0,ease:Power2.easeOut,onComplete:function(){flag=!0}}),a(".filter-section li").eq(filter_stage-1).delay(500).animate({textIndent:12},{step:function(b){a(this).css("-webkit-transform","scale("+b/10+")"),a(this).css("transform","scale("+b/10+")"),a(this).css("-moz-transform","scale("+b/10+")"),a(this).css("color","#FFF")},duration:filter_duration},"linear")}})}else TweenLite.to(this,.3,{scaleX:1.1,scaleY:1.1,scaleZ:1.1,z:.001,backgroundColor:"rgba(255,255,255,1)",perspective:1e3,force3D:!0,ease:Power2.easeInOut,perspective:1e3,onComplete:function(){flag=!0}}),this.addClass("selected");return this}}(jQuery),function(a){a.fn.notSelected_setting=function(){var b=this;return TweenLite.to(b,.2,{scaleX:1,scaleY:1,scaleZ:1,z:.001,zIndex:1,backgroundColor:"rgba(0,0,0,.5)",perspective:1e3,force3D:!0,ease:Power2.easeInOut,onComplete:function(){"filter"==b.attr("id")&&(a(".filter-section li").eq(filter_stage-1).animate({textIndent:10},{step:function(b){a(this).css("-webkit-transform","scale("+b/10+")"),a(this).css("transform","scale("+b/10+")"),a(this).css("-moz-transform","scale("+b/10+")"),a(this).css("color","#CCC")},duration:200},"linear"),TweenLite.to(a(".filter-section"),.6,{width:"90px",perspective:1e3,force3D:!0,ease:Power2.easeOut,delay:.2,onComplete:function(){TweenLite.to(a(".filter-section"),.1,{opacity:0}),flag=!0,filter_stage=1}}))}}),this.removeClass("selected"),this}}(jQuery),function(a){a.fn.isSelected_option=function(a){return a=a||.4,TweenLite.to(this,a,{backgroundColor:"rgb(255,255,255)",scaleX:1.3,scaleY:1.3,scaleZ:1.3,z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut,perspective:1e3,onComplete:function(){flag=!0}}),this.addClass("selectedOption"),this}}(jQuery),function(a){a.fn.notSelected_option=function(a){return a=a||.4,TweenLite.to(this,a,{backgroundColor:"rgb(96,96,96)",scaleX:1,scaleY:1,scaleZ:1,z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut,onComplete:function(){}}),this.removeClass("selectedOption"),this}}(jQuery),function(a){a.fn.findNext=function(b){var c=a("#app > .appbutton"),d=a("#app > .appbutton[data-number="+stage+"]"),e=stage,f=d.css("margin-left"),g=0;c.each(function(c,e){if(d.attr("id")!=e.id){var h=a(e).css("margin-left"),i=parseInt(h.split("p")[0]-f.split("p")[0]);"right"==b?i>0&&180>i&&(g=e.id):"left"==b&&-1*i>0&&180>-1*i&&(g=e.id)}});var h=a("#"+g),i=h.attr("data-number");return d.attr("data-number",i),h.attr("data-number",e),h}}(jQuery),function(a){a.fn.transition_opening=function(b){if(playWave(!1),circle_transition("rgba(0,0,0,.8)",!1),"optionmode"==b){var c=a(".appbutton[data-number="+parseInt(stage)+"]");c.notSelected();var d=1100;"main"==c.attr("data-type")?(a("#rename, #remove").css("display","none"),d=1100):(a("#rename, #remove").css("display","inline-block"),d=1500),TweenLite.to(a("#option"),.001,{zIndex:2e3,ease:Power4.easeInOut});var e=a("#option .optbutton"),f=0;e.each(function(a,b){TweenMax.delayedCall(f/1e3,function(){TweenLite.to(b,.8,{opacity:1,y:"-=100",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut,delay:.4})}),f+=200}),TweenMax.delayedCall(d/1e3,function(){a("#rearrange").isSelected_option()})}return"addfolder"==b&&TweenLite.to(a("#addfolder"),.5,{opacity:1,zIndex:3e3,delay:.5,perspective:1e3,force3D:!0,onComplete:function(){a(".applist").first().isSelected(1.5),applistposition=1}}),this}}(jQuery),function(a){a.fn.transition_closing=function(b){return"optionmode"==b||"rearrange"==b?TweenLite.to(a("#option .optbutton"),.8,{opacity:0,y:"+=100",z:.001,perspective:1e3,force3D:!0,ease:Power4.easeInOut}):"dummymode"==b?TweenLite.to(a("#dummy"),.4,{opacity:0,zIndex:-1,ease:Power4.easeIn}):"addfolder"==b&&(TweenLite.to(a("#addfolder-name p"),.3,{z:.001,perspective:1e3,force3D:!0,backgroundColor:"rgba(0,0,0,0)"}),TweenLite.to(a("#addfolder-name"),.3,{z:.001,perspective:1e3,force3D:!0,borderBottomColor:"#fff",borderWidth:"2px"}),TweenLite.to(a("#keyboard"),.6,{z:.001,perspective:1e3,force3D:!0,bottom:"-50%",ease:Power4.easeInOut}),TweenLite.to(a("#close"),.3,{opacity:0}),TweenLite.to(a("#addfolder"),.5,{opacity:0})),circle_transition_r(),TweenLite.to(this,.5,{opacity:0,perspective:1e3,force3D:!0,ease:Power4.easeIn,onComplete:function(){"optionmode"==b?(TweenLite.to(a("#option"),.001,{zIndex:-1,ease:Power4.easeInOut}),mode="navigation",3==option_stage&&a("#remove").hasClass("pressed")||TweenMax.delayedCall(.5,function(){a(".appbutton[data-number="+parseInt(stage)+"]").isSelected(),"folder"==a(".appbutton[data-number="+parseInt(stage)+"]").attr("data-type")&&TweenLite.to(a("#"+a(".appbutton[data-number="+parseInt(stage)+"]").attr("id")+" > .appbutton-folder"),speed3,{opacity:1}),a(".selectedOption").notSelected_option()}),option_stage=1):"dummymode"==b?(mode="navigation",TweenMax.delayedCall(0,function(){level=1,setting_stage=1,a(".appbutton[data-number="+parseInt(stage)+"]").isSelected()})):"rearrange"==b?(mode="rearrange",option_stage=1):"addfolder"==b&&("folder"==a(".appbutton[data-number="+parseInt(stage)+"]").attr("data-type")&&TweenLite.to(a("#"+a(".appbutton[data-number="+parseInt(stage)+"]").attr("id")+" > .appbutton-folder"),speed3,{opacity:1}),mode="navigation",a(".appbutton[data-number="+parseInt(stage)+"]").isSelected(),level=1,setting_stage=1,applistposition=1,folder_level=1,appselected=0,a("#addfolder-number--selected").text(appselected),a("#addfolder-done p").hasClass("inactive")||TweenLite.to(a("#addfolder-done p"),.3,{color:"#fff"}),TweenLite.to(a("#addfolder-done"),.3,{scaleX:1,scaleY:1,scaleZ:1,z:.001,perspective:1e3,force3D:!0,backgroundColor:"rgba(0,0,0,.8)",onComplete:function(){flag=!0}}),addfolder_stage=2,a("#addfolder-done p").addClass("inactive").css("color","#aaa"))}}),this}}(jQuery),$.fn.moveUp=function(){$.each(this,function(){$(this).after($(this).prev())})},$.fn.moveDown=function(){$.each(this,function(){$(this).before($(this).next())})},function(a){function b(){}const c=336*(window.devicePixelRatio||1),d='url("/style/images/appic_developer.png")',e="rgba(0, 0, 0, 0.5)",f=[0,0,0,.5],g=8.4;b.prototype={navigableIds:["search-button","search-input","edit-button","settings-button","filter-tab-group"],topElementIds:["search-button","search-input","edit-button","settings-button"],bottomElementIds:["filter-tab-group","filter-all-button","filter-tv-button","filter-device-button","filter-app-button","filter-website-button"],isNavigable:!0,navigableClasses:["filter-tab","command-button"],navigableScrollable:[],cardScrollable:void 0,folderScrollable:void 0,_focus:void 0,_focusScrollable:void 0,_folderCard:void 0,filterElementIds:["filter-all-button","filter-tv-button","filter-device-button","filter-app-button","filter-website-button"],filterManager:void 0,cardListElem:document.getElementById("card-list"),folderListElem:document.getElementById("folder-list"),cardManager:void 0,editButton:document.getElementById("edit-button"),settingsButton:document.getElementById("settings-button"),searchButton:document.getElementById("search-button"),timeElem:document.getElementById("time"),init:function(){var a=this;this.initClock(),this.cardManager=new CardManager,this.cardManager.init(),this.searchBar=new SearchBar,this.searchBar.init(document.getElementById("search-bar")),this.searchBar.on("shown",this.onSearchBarShown.bind(this)),this.searchBar.on("hidden",this.onSearchBarHidden.bind(this)),this.cardManager.getCardList().then(function(b){a.messageHandler=new MessageHandler,a.messageHandler.init(a),a._createCardList(b),a.cardScrollable=new XScrollable({frameElem:"card-list-frame",listElem:"card-list",itemClassName:"app-button",leftMargin:g}),a.folderScrollable=new XScrollable({frameElem:"folder-list-frame",listElem:"folder-list",itemClassName:"app-button",leftMargin:g,scale:.68,referenceElement:a.cardScrollable}),a.navigableScrollable=[a.cardScrollable,a.folderScrollable];var c=a._getNavigateElements();a.spatialNavigator=new SpatialNavigator(c),a.spatialNavigator.straightOnly=!0,a.keyNavigatorAdapter=new KeyNavigationAdapter,a.keyNavigatorAdapter.init(),a.keyNavigatorAdapter.on("move",a.onMove.bind(a)),a.keyNavigatorAdapter.on("enter-keyup",a.onEnter.bind(a)),a.cardListElem.addEventListener("transitionend",a.determineFolderExpand.bind(a)),a.cardManager.on("card-inserted",a.onCardInserted.bind(a,a.cardScrollable)),a.cardManager.on("card-removed",a.onCardRemoved.bind(a,a.cardScrollable)),a.cardManager.on("card-updated",a.onCardUpdated.bind(a)),a.spatialNavigator.on("focus",a.handleFocus.bind(a)),a.spatialNavigator.on("unfocus",a.handleUnfocus.bind(a));var d=a.handleCardFocus.bind(a),e=a.handleCardUnfocus.bind(a),f=a.handleCardUnhover.bind(a);a.navigableScrollable.forEach(function(b){b.on("focus",d),b.on("unfocus",e),b.on("unhover",f),b.isEmpty()&&a.spatialNavigator.remove(b)}),a.edit=new Edit,a.edit.init(a.spatialNavigator,a.cardManager,a.cardScrollable,a.folderScrollable),a.edit.on("arrange",a.onArrangeMode.bind(a)),a.filterManager=new FilterManager,a.filterManager.init({cardListElem:a.cardListElem,cardScrollable:a.cardScrollable,home:a,cardManager:a.cardManager}),a.searchButton.addEventListener("click",function(){a.searchBar.show(),a.searchButton.classList.add("hidden")}.bind(a)),a.endBubble=null,document.addEventListener("visibilitychange",a.onVisibilityChange.bind(a)),"visible"===document.visibilityState&&a.onVisibilityChange(),b.forEach(function(b){b instanceof Folder&&(b.on("card-inserted",a.onCardInserted.bind(a,a.folderScrollable)),b.on("card-removed",a.onCardRemoved.bind(a,a.folderScrollable)))}),a.spatialNavigator.focus(a.cardScrollable)})},onVisibilityChange:function(){if("visible"===document.visibilityState){Utils.holdFocusForAnimation(),this.cardListElem.classList.remove("hidden");var a=this;Promise.all([new Promise(function(b){a.skipBubble=Animations.doBubbleAnimation(a.cardListElem,".app-button",100,b)}),new Promise(function(b){a._folderCard?a.skipFolderBubble=Animations.doBubbleAnimation(a.folderListElem,".app-button",100,b):b()})]).then(function(){a.messageHandler.resumeActivity()||a.spatialNavigator.focus(),a.isNavigable=!0,a.skipBubble=null,a.skipFolderBubble=null})}else this.cardListElem.classList.add("hidden"),this.messageHandler.stopActivity(),this.isNavigable=!1,this.skipBubble&&this.skipBubble(),this.skipFolderBubble&&this.skipFolderBubble(),this.cardScrollable.isSliding&&this.cardScrollable.endSlide(),
this.filterManager.resetFilter()},initClock:function(){var a=this;navigator.mozL10n.ready(function(){a.clock=new Clock,a.clock.start(a.updateClock.bind(a)),window.addEventListener("moztimechange",a.restartClock.bind(a)),window.addEventListener("timeformatchange",a.restartClock.bind(a))})},_localizeCardName:function(a,b){if(a&&b){var c=document.documentElement.lang,d=this.cardManager.resolveCardName(b,c);d&&d.raw?(a.removeAttribute("data-l10n-id"),a.textContent=d.raw):d&&d.id&&SharedUtils.localizeElement(a,d)}},onCardInserted:function(a,b,c,d){b instanceof Folder&&(b.on("card-inserted",this.onCardInserted.bind(this,this.folderScrollable)),b.on("card-removed",this.onCardRemoved.bind(this,this.folderScrollable)));var e=this.createCardNode(b),f=e.firstElementChild;f.classList.add("new-card"),f.classList.add("new-card-transition"),f.addEventListener("transitionend",function g(){f.classList.remove("new-card-transition"),f.classList.remove("last-card"),f.removeEventListener("transitionend",g)}),this.isNavigable=!1,a.on("slideEnd",function(){f.classList.remove("new-card"),a.nodes.indexOf(e)===a.nodes.length-1&&f.classList.add("last-card"),this.isNavigable=!0}.bind(this)),d?a.insertNodeOver(e,c):a.insertNodeBefore(e,c)},onCardUpdated:function(a,b){var c=this,d=this.cardScrollable.getItemFromNode(this.cardScrollable.getNode(b)),e=SharedUtils.nodeListToArray(d.getElementsByTagName("span"));e.forEach(function(b){b.classList.contains("name")&&c._localizeCardName(b,a)})},onCardRemoved:function(a,b){b.forEach(function(b){var c=a.getNode(b);c&&c.dataset.revokableURL&&URL.revokeObjectURL(c.dataset.revokableURL)},this),a.removeNodes(b)},_setCardIcon:function(a,b,c,f){try{var g=URL.createObjectURL(c);f?(a.style.backgroundColor=f,a.classList.add("fitted"),b.backgroundType="fitted"):(a.classList.add("fullsized"),b.backgroundType="fullsized"),a.dataset.revokableURL=g,a.style.backgroundImage='url("'+g+'")'}catch(h){a.style.backgroundImage=d,a.style.backgroundColor=e}},_createWave:function(a,b){var c=document.createElement("span");c.className="icon",c.dataset.icon=b.deckClass;var d=document.createElement("div");d.className="deck-wave",d.classList.add("wave-front"),d.classList.add(b.deckClass+"-wave-front"),d.classList.add("wave-paused");var e=document.createElement("div");e.className="deck-wave",e.classList.add("wave-back"),e.classList.add(b.deckClass+"-wave-back"),a.appendChild(e),a.appendChild(c),a.appendChild(d),a.classList.add("deck-"+b.deckClass)},_fillCardIcon:function(a,b){var d=b.nativeApp&&b.nativeApp.manifestURL,f=this;b.thumbnail?this._setCardIcon(a,b,b.thumbnail,b.backgroundColor):b.cachedIconBlob?b.cachedIconBlob&&this._setCardIcon(a,b,b.cachedIconBlob,b.backgroundColor):this.cardManager.getIconBlob({manifestURL:d,entryPoint:b.entryPoint,preferredSize:c}).then(function(d){var g=d[0],h=d[1];h>=c?f._setCardIcon(a,b,g,null):f._getIconColor(g,function(c,d){d?f._setCardIcon(a,b,g,e):f._setCardIcon(a,b,g,"rgba("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+")")}),b.cachedIconBlob=g})},_getIconColor:function(a,b){function c(e,g){g?b(null,g):e[3]<255&&.5>d?(d+=.25,SharedUtils.readColorCode(a,.5,d,c)):b(e[3]<255?f:e,g)}var d=0;SharedUtils.readColorCode(a,.5,0,c)},onArrangeMode:function(){this._focusScrollable!==this.folderScrollable&&this.cleanFolderScrollable()},createCardNode:function(a){var b=document.createElement("div");b.classList.add("card");var c=document.createElement("smart-button");c.setAttribute("type","app-button"),c.className="app-button",c.dataset.cardId=a.cardId;var d=document.createElement("section");d.className="card-panel";var e=document.createElement("smart-button");e.dataset.icon="rename",e.classList.add("rename-btn");var f=document.createElement("smart-button");f.dataset.icon="delete",f.classList.add("delete-btn"),d.appendChild(e),d.appendChild(f),b.appendChild(c),b.appendChild(d),a instanceof Application?"tv"===a.group?(c.classList.add("tv-channel"),c.dataset.icon="tv",c.setAttribute("app-type","tv")):(c.setAttribute("app-type","app"),this._fillCardIcon(c,a)):a instanceof Deck?(c.setAttribute("app-type","deck"),"website"===a.group?this._fillCardIcon(c,a):this._createWave(c,a)):a instanceof Folder&&(c.setAttribute("app-type","folder"),c.dataset.icon="folder");var g=document.createElement("span");return g.classList.add("name"),this._localizeCardName(g,a),c.appendChild(g),b},_createCardList:function(a){a.forEach(function(a){this.cardListElem.appendChild(this.createCardNode(a))}.bind(this))},onMove:function(a){if(this.isNavigable&&!this.edit.onMove(a)){var b=this.spatialNavigator.getFocusedElement();"XScrollable"==b.CLASS_NAME&&b.move(a)||this.spatialNavigator.move(a)}},onEnter:function(){if(this.isNavigable&&!this.edit.onEnter()){var a=this.focusElem;if(a===this.settingsButton)this.openSettings();else if(a===this.editButton)this.cleanFolderScrollable(),this.edit.toggleEditMode(),this.filterManager.resetFilter();else if(a&&this.filterElementIds.indexOf(a.id)>-1)this.cleanFolderScrollable();else{var b,c=a.dataset.cardId;b=this.focusScrollable===this.folderScrollable?this._folderCard.findCard({cardId:c}):this.cardManager.findCardFromCardList({cardId:c}),b&&b.launch()}}},onSearchBarShown:function(){var a=function(){document.removeEventListener("visibilitychange",a),this.searchBar.hide()}.bind(this);document.addEventListener("visibilitychange",a);var b=new MozActivity({name:"search",data:{keyword:""}});b.onerror=a},onSearchBarHidden:function(){this.searchButton.classList.remove("hidden")},_getNavigateElements:function(){var a=[];return this.navigableIds.forEach(function(b){var c=document.getElementById(b);c&&a.push(c)}),this.navigableClasses.forEach(function(b){var c=document.getElementsByClassName(b);c.length&&(a=a.concat(Array.prototype.slice.call(c)))}),a=a.concat(this.navigableScrollable)},handleFocus:function(a){if("XScrollable"==a.CLASS_NAME)this._focusScrollable=a,a.focus(),this.checkFocusedGroup();else if(a.nodeName)switch(this._focus&&this._focus.blur(),a.nodeName.toLowerCase()){case"menu-group":this.handleFocusMenuGroup(a);break;default:a.focus(),this._focus=a,this._focusScrollable=void 0,this.checkFocusedGroup(a)}else this._focusScrollable=void 0},handleUnfocus:function(a){"XScrollable"==a.CLASS_NAME&&this.handleCardUnfocus(a,a.currentItem,a.getNodeFromItem(a.currentItem))},checkFocusedGroup:function(a){this._focusedGroup&&(a&&this._focusedGroup.contains(a)||(this._focusedGroup.close(),this._focusedGroup=null))},handleFocusMenuGroup:function(a){var b=this;a.once("opened",function(){b.spatialNavigator.remove(a);for(var c=a.firstElementChild,d=null;c;){switch(c.nodeName.toLowerCase()){case"style":case"script":break;default:d=d||c,b.spatialNavigator.add(c)}c=c.nextElementSibling}d&&b.spatialNavigator.focus(d)}),a.once("will-close",function(){a.off("opened"),b.spatialNavigator.add(a);for(var c=a.firstElementChild;c;){switch(c.nodeName.toLowerCase()){case"style":case"script":break;default:b.spatialNavigator.remove(c)}c=c.nextElementSibling}}),this.checkFocusedGroup(a),this._focusedGroup=a,a.open()},handleCardFocus:function(a,b,c){this._focus=b,"edit"===this.edit.mode&&this.edit.handleCardFocus(a,b,c),b.focus(),c.classList.add("focused"),a===this.cardScrollable&&this._folderCard&&b.dataset.cardId!==this._folderCard.cardId&&!this.cardScrollable.isHovering&&this.cleanFolderScrollable()},cleanFolderScrollable:function(a){this._focusScrollable!==this.folderScrollable||a||this.spatialNavigator.focus(this.cardScrollable),this.spatialNavigator.remove(this.folderScrollable),this.folderScrollable.clean(),this._folderCard=void 0,this.edit.isFolderReady=!1,this.cardScrollable.setColspanOnFocus(0)},handleCardUnfocus:function(a,b,c){c&&c.classList.remove("focused")},handleCardUnhover:function(){this.cleanFolderScrollable()},determineFolderExpand:function(a){this.focusScrollable!==this.cardScrollable||!a.originalTarget.classList.contains("app-button")||this._folderCard&&this._folderCard.cardId===a.originalTarget.dataset.cardId||!(a.originalTarget.classList.contains("focused")&&"outline-width"===a.propertyName&&"arrange"!==document.getElementById("main-section").dataset.mode||a.originalTarget.classList.contains("hovered"))||this.buildFolderList(a.originalTarget)},buildFolderList:function(a){var b=a.dataset.cardId,c=this.cardManager.findCardFromCardList({cardId:b});if(c instanceof Folder){this._folderCard=c;var d=this._folderCard.getCardList();if(0===d.length)return this.edit.isFolderReady=!0,void(this.folderListElem.style.transition="none");d.forEach(function(a){this.folderScrollable.addNode(this.createCardNode(a))},this);var e=!0,f=function(){e?(e=!1,this.folderListElem.style.transition="none",this.folderScrollable.realignToReferenceElement(),this.skipFolderBubble=Animations.doBubbleAnimation(this.folderListElem,".app-button",100,function(){this.spatialNavigator.add(this.folderScrollable),this.edit.isFolderReady=!0,this.skipFolderBubble=void 0}.bind(this)),window.requestAnimationFrame(f)):this.folderListElem.style.transition=""}.bind(this);window.requestAnimationFrame(f)}},openSettings:function(){new MozActivity({name:"configure",data:{}})},updateClock:function(){var a=new Date,b=navigator.mozL10n.get,c=window.navigator.mozHour12,d=new navigator.mozL10n.DateTimeFormat,e=b(c?"shortTimeFormat12":"shortTimeFormat24");e=e.replace("%p","").trim();var f=d.localeFormat(a,e);this.timeElem.innerHTML=f,this.timeElem.dataset.ampm=c?d.localeFormat(a,"%p"):""},restartClock:function(){navigator.mozL10n.ready(function(){this.clock.stop(),this.clock.start(this.updateClock.bind(this))}.bind(this))},get focusElem(){return this._focus},get focusScrollable(){return this._focusScrollable}},a.Home=b}(window),window.home=new Home,window.home.init();